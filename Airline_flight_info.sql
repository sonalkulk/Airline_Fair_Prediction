create database Airline_flight_info;

use Airline_flight_info;


select * from flight_info1;

select count(*)
from flight_info1;

alter table flight_info1
add column JourneyDate date;

update flight_info1
set JourneyDate = str_to_date(Date_of_journey, "%d-%m- %Y");

set SQL_SAFE_UPDATES=0;

alter table flight_info1
add column Departure_Time time;

alter table flight_info1
add column Arr_Time time;

alter table flight_info1
add column Time_Duration time;

update flight_info1
set Departure_Time = str_to_date(Dep_Time, "%H:%i:%s");

update flight_info1
set Arr_Time = str_to_date(Arrival_Time, "%H:%i:%s");

update flight_info1
set Time_Duration = time_format(Duration, "%H:%i");

/* Monthwise Number of flights by each airline */

select airline, count(*) as Airline_count, monthname(JourneyDate) as Month_Of_Journey
from airlines a inner join flight_info1 f on a.ID=f.ID
group by monthname(JourneyDate)
order by count(*) desc;

/*Monthly revenue of each airline*/

select distinct ID, sum(price) as Airline_revenue, monthname(JourneyDate) as Month_Of_Journey,
		dense_rank() over(order by sum(price) desc) as Revenue_generated
from flight_info1
group by monthname(JourneyDate);

select distinct ID, price
from flight_info1
order by ID asc;

select * from flight_info1
limit 10;

/*Distinct source and destination pairs and number of non-stop flights avaiable for each*/

select t1.ID, t1.Source, t1.Destination, count(t1.Total_Stops)
from flight_info1 t1 inner join flight_info1 t2
where t1.ID = t2.ID and t1.Source < t2.Source and t1.Total_Stops="non-stop"
group by t1.Source;

/*At what time (Hr)  number of flights are maximum*/

select Departure_Time, count(*) as Number_of_Flights
from flight_info1
group by Departure_Time
order by 2 desc;

/*Airline having maximum average price sorted by Airlines*/

select f.ID, a.Airline, round(avg(Price),2) as Average_price
from airlines a inner join flight_info1 f on a.ID = f.ID
group by Airline
order by avg(price) desc;

/*Monthly revenue generated by each Airline*/

select f.ID, a.Airline, monthname(JourneyDate) as month, sum(price) as Total_revenue
from airlines a inner join flight_info1 f on a.ID = f.ID
group by monthname(JourneyDate), Airline
order by 4 desc;

/*Most expenssive Airline*/

select f.ID, a.Airline, price
from airlines a inner join flight_info1 f on a.ID = f.ID
group by Airline
order by 3 desc;

/*Month that has least revenue*/

select monthname(JourneyDate) as month, sum(price) as Total_revenue
from flight_info1
group by monthname(JourneyDate)
order by 2 desc;

/*which source has shortest duration of time*/

select source, Destination, min(Time_Duration)
from flight_info1;

/*which source has Longest duration of time*/

select source, Destination, max(Time_Duration)
from flight_info1;


